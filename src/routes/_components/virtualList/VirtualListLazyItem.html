{#if props}
  <VirtualListItem {component}
                   {offset}
                   {props}
                   {key}
                   {index}
  />
{/if}
<script>
  import VirtualListItem from './VirtualListItem'
  import { mark, stop } from '../../_utils/marks'
  import { scheduleIdlePriorityTask } from '../../_utils/scheduleIdlePriorityTask'

  export default {
    async oncreate () {
      let { makeProps, key, index } = this.get()
      if (makeProps) {
        let props = await makeProps(key)
        // render virtual list items lazily, by index, so that
        // the earlier ones are rendered first
        scheduleIdlePriorityTask(index, () => {
          mark('VirtualListLazyItem set props')
          this.set({ props: props })
          stop('VirtualListLazyItem set props')
        })
      }
    },
    data: () => ({
      props: void 0
    }),
    components: {
      VirtualListItem
    }
  }
</script>
