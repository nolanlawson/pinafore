<div class="virtual-list-lazy-item {shown ? 'shown' : ''}">
  {#if props}
    <VirtualListItem {component}
                     {offset}
                     {props}
                     {key}
                     {index}
    />
  {/if}
</div>
<style>
  .virtual-list-lazy-item {
    display: none;
  }
  .virtual-list-lazy-item.shown {
    display: block;
  }
</style>
<script>
  import VirtualListItem from './VirtualListItem'
  import { mark, stop } from '../../_utils/marks'
  import { observe } from 'svelte-extras'

  export default {
    oncreate () {
      this.observe('key', async key => {
        let { makeProps } = this.get()
        if (!key || !makeProps) {
          return
        }
        this.set({shown: false})
        let props = await makeProps(key)
        this.set({shown: true})
        mark('VirtualListLazyItem set props')
        this.set({props: props})
        stop('VirtualListLazyItem set props')
      })
    },
    data: () => ({
      props: void 0,
      shown: false
    }),
    methods: {
      observe
    },
    components: {
      VirtualListItem
    }
  }
</script>